extends ../base
include ../mixins/avatar

block content
    div#videoContainer(data-id=video._id data-logged=loggedIn)
        video(src=`/${video.videoUrl}`)
        div#videoControls
            button#playBtn Play
            button#muteBtn Mute
            input#volumeRange(type="range" value="1" step="0.1" min="0" max="1")
            div
                span#currentTime
                span  / 
                span#totalTime
            input#timeline(type="range" value="0" step="0.1" min="0")
            button#fullscreenBtn Enter Full Screen
    //-
        div(style="display: flex;")
            +avatar(video.owner)
            a(href=`/users/${video.owner._id}`)=video.owner.name
        div
            small #{video.meta.views}#{(video.meta.views <= 1) ? "view" : "views"} 
            small #{video.createdAt}
            div #{video.hashtags.join(" ")}
            p=video.description
    if String(video.owner._id) === String(loggedInUser._id)
        hr
        a(href=`${video._id}/edit`) Edit video &rarr;
        br
        a(href=`${video._id}/delete`) Delete video &rarr;
    
    if loggedIn
        div
            form#commentForm
                textarea(cols="30" rows="10" required placeholder="Write a comment")
                button Add

    div
        ul#commentsList
            each comment in video.comments.reverse()
                li(data-id=comment._id)
                    span=comment.text
                    if String(comment.owner._id) === String(loggedInUser._id)
                        button ❌

block scripts
    script(src="/assets/js/videoPlayer.js")
    if loggedIn
        script(src="/assets/js/comment.js")